#!/usr/bin/env python3

import rclpy
from rclpy.node import Node
from geometry_msgs.msg import PoseStamped
import numpy as np

class CartesianMotionPublisher(Node):
    def __init__(self):
        super().__init__('cartesian_motion_publisher')

        self.controller_name = '/target_frame'
        self.publisher = self.create_publisher(PoseStamped, self.controller_name, 10)

        self.cartesian_goals = [
            {'x': 471, 'y': -6, 'z': 237, 'w': 0},
            {'x': 485.28, 'y': -262.92, 'z': 150, 'w': 0},
            {'x': 485.28, 'y': -262.92, 'z': 125, 'w': 0},
            {'x': 483.84, 'y': -261.96, 'z': 125, 'w': 0},
            {'x': 482.04, 'y': -258.6, 'z': 125, 'w': 0},
            {'x': 484.92, 'y': -254.4, 'z': 125, 'w': 0},
            {'x': 494.76, 'y': -243.84, 'z': 125, 'w': 0},
            {'x': 494.76, 'y': -243.84, 'z': 150, 'w': 0},
            {'x': 508.32, 'y': -243.84, 'z': 150, 'w': 0},
            {'x': 508.32, 'y': -243.84, 'z': 125, 'w': 0},
            {'x': 505.08, 'y': -239.64, 'z': 125, 'w': 0},
            {'x': 504.36, 'y': -235.8, 'z': 125, 'w': 0},
            {'x': 504.6, 'y': -216.12, 'z': 125, 'w': 0},
            {'x': 506.28, 'y': -204.0, 'z': 125, 'w': 0},
            {'x': 506.03999999999996, 'y': -199.92000000000002, 'z': 125, 'w': 0},
            {'x': 506.03999999999996, 'y': -199.92000000000002, 'z': 150, 'w': 0},
            {'x': 503.28, 'y': -242.88, 'z': 150, 'w': 0},
            {'x': 503.28, 'y': -242.88, 'z': 125, 'w': 0},
            {'x': 500.4, 'y': -241.32, 'z': 125, 'w': 0},
            {'x': 494.52, 'y': -241.56, 'z': 125, 'w': 0},
            {'x': 461.52, 'y': -247.2, 'z': 125, 'w': 0},
            {'x': 458.76, 'y': -246.6, 'z': 125, 'w': 0},
            {'x': 457.08, 'y': -245.4, 'z': 125, 'w': 0},
            {'x': 454.56, 'y': -242.16, 'z': 125, 'w': 0},
            {'x': 455.28, 'y': -234.72, 'z': 125, 'w': 0},
            {'x': 455.4, 'y': -209.28, 'z': 125, 'w': 0},
            {'x': 456.6, 'y': -199.2, 'z': 125, 'w': 0},
            {'x': 456.6, 'y': -199.2, 'z': 150, 'w': 0},
            {'x': 496.44, 'y': -232.32, 'z': 150, 'w': 0},
            {'x': 496.44, 'y': -232.32, 'z': 125, 'w': 0},
            {'x': 491.52, 'y': -229.32, 'z': 125, 'w': 0},
            {'x': 489.72, 'y': -226.68, 'z': 125, 'w': 0},
            {'x': 489.72, 'y': -226.68, 'z': 150, 'w': 0},
            {'x': 467.64, 'y': -237.48000000000002, 'z': 150, 'w': 0},
            {'x': 467.64, 'y': -237.48000000000002, 'z': 125, 'w': 0},
            {'x': 466.32, 'y': -234.84, 'z': 125, 'w': 0},
            {'x': 473.76, 'y': -227.76, 'z': 125, 'w': 0},
            {'x': 473.76, 'y': -227.76, 'z': 150, 'w': 0},
            {'x': 497.76, 'y': -219.36, 'z': 150, 'w': 0},
            {'x': 497.76, 'y': -219.36, 'z': 125, 'w': 0},
            {'x': 493.92, 'y': -219.24, 'z': 125, 'w': 0},
            {'x': 470.88, 'y': -223.56, 'z': 125, 'w': 0},
            {'x': 465.12, 'y': -223.07999999999998, 'z': 125, 'w': 0},
            {'x': 465.12, 'y': -223.07999999999998, 'z': 150, 'w': 0},
            {'x': 484.08, 'y': -237.48000000000002, 'z': 150, 'w': 0},
            {'x': 484.08, 'y': -237.48000000000002, 'z': 125, 'w': 0},
            {'x': 480.96, 'y': -234.12, 'z': 125, 'w': 0},
            {'x': 482.04, 'y': -211.44, 'z': 125, 'w': 0},
            {'x': 481.44, 'y': -202.2, 'z': 125, 'w': 0},
            {'x': 481.44, 'y': -202.2, 'z': 150, 'w': 0},
            {'x': 484.2, 'y': -218.4, 'z': 150, 'w': 0},
            {'x': 484.2, 'y': -218.4, 'z': 125, 'w': 0},
            {'x': 488.52, 'y': -212.64, 'z': 125, 'w': 0},
            {'x': 495.36, 'y': -206.28, 'z': 125, 'w': 0},
            {'x': 499.2, 'y': -204.36, 'z': 125, 'w': 0},
            {'x': 499.2, 'y': -204.36, 'z': 150, 'w': 0},
            {'x': 474.24, 'y': -214.44, 'z': 150, 'w': 0},
            {'x': 474.24, 'y': -214.44, 'z': 125, 'w': 0},
            {'x': 467.88, 'y': -209.76, 'z': 125, 'w': 0},
            {'x': 466.56, 'y': -207.48000000000002, 'z': 125, 'w': 0},
            {'x': 466.56, 'y': -207.48000000000002, 'z': 150, 'w': 0},
            {'x': 531.48, 'y': -186.48000000000002, 'z': 150, 'w': 0},
            {'x': 531.48, 'y': -186.48000000000002, 'z': 125, 'w': 0},
            {'x': 524.04, 'y': -184.32, 'z': 125, 'w': 0},
            {'x': 499.8, 'y': -187.8, 'z': 125, 'w': 0},
            {'x': 440.76, 'y': -192.84, 'z': 125, 'w': 0},
            {'x': 431.28, 'y': -190.32, 'z': 125, 'w': 0},
            {'x': 429.12, 'y': -188.28, 'z': 125, 'w': 0},
            {'x': 429.12, 'y': -188.28, 'z': 150, 'w': 0},
            {'x': 489.72, 'y': -200.04000000000002, 'z': 150, 'w': 0},
            {'x': 489.72, 'y': -200.04000000000002, 'z': 125, 'w': 0},
            {'x': 485.28, 'y': -195.72, 'z': 125, 'w': 0},
            {'x': 485.52, 'y': -191.88, 'z': 125, 'w': 0},
            {'x': 487.32, 'y': -183.24, 'z': 125, 'w': 0},
            {'x': 492.36, 'y': -173.28, 'z': 125, 'w': 0},
            {'x': 498.84000000000003, 'y': -166.8, 'z': 125, 'w': 0},
            {'x': 503.76, 'y': -163.8, 'z': 125, 'w': 0},
            {'x': 510.96, 'y': -160.56, 'z': 125, 'w': 0},
            {'x': 521.64, 'y': -157.8, 'z': 125, 'w': 0},
            {'x': 521.64, 'y': -157.8, 'z': 150, 'w': 0},
            {'x': 482.15999999999997, 'y': -185.76, 'z': 150, 'w': 0},
            {'x': 482.15999999999997, 'y': -185.76, 'z': 125, 'w': 0},
            {'x': 463.44, 'y': -168.84, 'z': 125, 'w': 0},
            {'x': 454.8, 'y': -162.36, 'z': 125, 'w': 0},
            {'x': 452.64, 'y': -161.28, 'z': 125, 'w': 0},
            {'x': 443.16, 'y': -159.24, 'z': 125, 'w': 0},
            {'x': 430.92, 'y': -157.68, 'z': 125, 'w': 0},
            {'x': 430.92, 'y': -157.68, 'z': 150, 'w': 0},
            {'x': 631, 'y': 0, 'z': 140, 'w': 0},
            {'x': 631, 'y': 0, 'z': 128, 'w': 0},
            {'x': 631, 'y': 0, 'z': 140, 'w': 0},
            {'x': 595, 'y': 0, 'z': 140, 'w': 0},
            {'x': 595, 'y': 0, 'z': 150, 'w': 0},
            {'x': 486.48, 'y': -151.56, 'z': 150, 'w': 0},
            {'x': 486.48, 'y': -151.56, 'z': 125, 'w': 0},
            {'x': 480.96, 'y': -146.76, 'z': 125, 'w': 0},
            {'x': 481.68, 'y': -116.28, 'z': 125, 'w': 0},
            {'x': 483.72, 'y': -113.76, 'z': 125, 'w': 0},
            {'x': 483.72, 'y': -113.76, 'z': 150, 'w': 0},
            {'x': 477.24, 'y': -133.44, 'z': 150, 'w': 0},
            {'x': 477.24, 'y': -133.44, 'z': 125, 'w': 0},
            {'x': 474.96, 'y': -132.48, 'z': 125, 'w': 0},
            {'x': 470.28, 'y': -132.72, 'z': 125, 'w': 0},
            {'x': 458.4, 'y': -135.84, 'z': 125, 'w': 0},
            {'x': 452.52, 'y': -136.08, 'z': 125, 'w': 0},
            {'x': 452.52, 'y': -136.08, 'z': 150, 'w': 0},
            {'x': 527.52, 'y': -106.56, 'z': 150, 'w': 0},
            {'x': 527.52, 'y': -106.56, 'z': 125, 'w': 0},
            {'x': 520.56, 'y': -105.36, 'z': 125, 'w': 0},
            {'x': 492.0, 'y': -109.68, 'z': 125, 'w': 0},
            {'x': 446.16, 'y': -114.24000000000001, 'z': 125, 'w': 0},
            {'x': 440.88, 'y': -113.88, 'z': 125, 'w': 0},
            {'x': 433.2, 'y': -111.6, 'z': 125, 'w': 0},
            {'x': 433.2, 'y': -111.6, 'z': 150, 'w': 0},
            {'x': 485.28, 'y': -107.76, 'z': 150, 'w': 0},
            {'x': 485.28, 'y': -107.76, 'z': 125, 'w': 0},
            {'x': 481.68, 'y': -104.28, 'z': 125, 'w': 0},
            {'x': 483.24, 'y': -60.24000000000001, 'z': 125, 'w': 0},
            {'x': 481.68, 'y': -50.52000000000001, 'z': 125, 'w': 0},
            {'x': 481.68, 'y': -50.52000000000001, 'z': 150, 'w': 0},
            {'x': 473.64, 'y': -96.0, 'z': 150, 'w': 0},
            {'x': 473.64, 'y': -96.0, 'z': 125, 'w': 0},
            {'x': 461.04, 'y': -89.76, 'z': 125, 'w': 0},
            {'x': 458.15999999999997, 'y': -86.76, 'z': 125, 'w': 0},
            {'x': 456.0, 'y': -82.92, 'z': 125, 'w': 0},
            {'x': 456.0, 'y': -82.92, 'z': 150, 'w': 0},
            {'x': 0, 'y': 0, 'z': 0, 'w': 0},
        ]

        self.move_time = 2

    def publish_cartesian_goals(self):
        """ Publish predefined Cartesian trajectories to move the robot in a straight line. """
        for cartesian_goal in self.cartesian_goals:
            msg = PoseStamped()
            msg.pose.position.x = cartesian_goal['x']
            msg.pose.position.y = cartesian_goal['y']
            msg.pose.position.z = cartesian_goal['z']
            msg.pose.orientation.w = cartesian_goal['w']

            self.publisher.publish(msg)
            rclpy.spin_once(self, timeout_sec=self.move_time)
            self.get_logger().info(f'Published Cartesian goal: {{cartesian_goal}}')


def main(args=None):
    rclpy.init(args=args)
    cartesian_motion_publisher = CartesianMotionPublisher()
    cartesian_motion_publisher.publish_cartesian_goals()
    cartesian_motion_publisher.destroy_node()
    rclpy.shutdown()


if __name__ == '__main__':
    main()
